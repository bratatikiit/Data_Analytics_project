import pandas as pd

# Read the CSV file
df = pd.read_csv('./extract_year_manufacturer.csv')

# Group by Country Name, year, and vaccine type and sum up total vaccinations
grouped = df.groupby(['Country Name', 'Year', 'Vaccine'])['Vaccinated'].sum().reset_index()

# Write the aggregated data to a new CSV file
grouped.to_csv('aggregated_vaccine_data.csv', index=False)

print("Aggregated data saved to aggregated_vaccine_data.csv")
